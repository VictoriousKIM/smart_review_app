---
alwaysApply: true
---

## ë°ì´í„°ë² ì´ìŠ¤ ë¤í”„ (ì‹œë“œ ë°ì´í„°)

### âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (ë¡œì»¬)
```bash
npx supabase db dump --local --data-only -f supabase/seed.sql
```

<!-- í”„ë¡œë•ì…˜ ì‚¬ìš© ì‹œ (ì£¼ì„ ì²˜ë¦¬):
### âŒ ì˜ëª»ëœ ë°©ë²• (ì›ê²©/í”„ë¡œë•ì…˜)
```bash
npx supabase db dump --data-only -f supabase/seed.sql
```
-->

### ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ì••ì¶•
```bash
npx supabase migration squash
```

### ë¡œì»¬ëŒ€ì‹œë³´ë“œ ë³€ê²½ì‚¬í•­ ë§ˆì´ê·¸ë ˆì´ì…˜ ì ìš©
```bash
npx supabase db diff -f <migration_name>
```

### ìŠ¤í‚¤ë§ˆ ë³€ê²½ ë§ˆì´ê·¸ë ˆì´ì…˜ ì¶”ê°€
```bash
# í˜„ì¬ DBì™€ ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ì°¨ì´ì  í™•ì¸ í›„ ìƒˆ ë§ˆì´ê·¸ë ˆì´ì…˜ ìƒì„±
npx supabase db diff --local --schema public -f supabase/migrations/YYYYMMDDHHMMSS_description.sql
```

**ì¤‘ìš”:**
- ë¡œì»¬ Supabaseë¥¼ ì‚¬ìš©í•˜ë¯€ë¡œ í•­ìƒ `--local` í”Œë˜ê·¸ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
- `seed.sql`ì€ ë¡œì»¬ ê°œë°œìš© í…ŒìŠ¤íŠ¸ ë°ì´í„°ì…ë‹ˆë‹¤
- ë¡œì»¬ í™˜ê²½ì—ì„œë§Œ ì‘ì—…í•˜ë¯€ë¡œ ì›ê²© DBì™€ì˜ ë™ê¸°í™” ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤
<!-- í”„ë¡œë•ì…˜ ì‚¬ìš© ì‹œ ì£¼ì˜ì‚¬í•­ (ì£¼ì„ ì²˜ë¦¬):
- `--local` í”Œë˜ê·¸ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì›ê²©(í”„ë¡œë•ì…˜) DBì—ì„œ ë¤í”„ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤
- ë¡œì»¬ ê°œë°œ í™˜ê²½ê³¼ í”„ë¡œë•ì…˜ í™˜ê²½ì€ ë°ì´í„° êµ¬ì¡°ê°€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ì›ê²© DBì—ì„œ ë¤í”„ë¥¼ ê°€ì ¸ì˜¤ë©´ ë¡œì»¬ í™˜ê²½ê³¼ ë§ì§€ ì•Šì•„ ë¦¬ì…‹ì´ ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
-->

## Git ì»¤ë°‹ ë©”ì‹œì§€ ì‘ì„± ê·œì¹™

### âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (ì˜ì–´ë¡œ ì‘ì„±)
```bash
git commit -m "feat: add point cancellation feature

- Add cancel cash transaction RPC function
- Update UI to show cancel button for pending transactions
- Remove reviewer charge functionality"
```

### âŒ ì˜ëª»ëœ ë°©ë²• (í•œê¸€ë¡œ ì‘ì„±)
```bash
git commit -m "feat: í¬ì¸íŠ¸ ì·¨ì†Œ ê¸°ëŠ¥ ì¶”ê°€"
```

**ì¤‘ìš”:**
- ëª¨ë“  ì»¤ë°‹ ë©”ì‹œì§€ëŠ” **ì˜ì–´ë¡œ ì‘ì„±**í•´ì•¼ í•©ë‹ˆë‹¤
- í•œê¸€ ì»¤ë°‹ ë©”ì‹œì§€ëŠ” Windows PowerShellì—ì„œ ê¹¨ì ¸ ë³´ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤
- GitHubì—ì„œëŠ” ì •ìƒ í‘œì‹œë˜ì§€ë§Œ, ë¡œì»¬ í„°ë¯¸ë„ì—ì„œ ê°€ë…ì„±ì´ ë–¨ì–´ì§‘ë‹ˆë‹¤
- ì»¤ë°‹ íƒ€ì…: `feat`, `fix`, `chore`, `refactor`, `docs`, `style`, `test` ë“±

## ğŸ“± Flutter ì›¹ ì•± ì ‘ê·¼ì„± í™œì„±í™”

Flutter ì›¹ ì•±ì—ì„œ ì ‘ê·¼ì„± ë²„íŠ¼ì„ í™œì„±í™”í•˜ëŠ” ë°©ë²•:

```javascript
// ì ‘ê·¼ì„± í™œì„±í™” (í•„ìˆ˜!)
await page.evaluate(() => {
  const accessibilityButton = document.querySelector('flt-semantics-placeholder[aria-label="Enable accessibility"]');
  if (accessibilityButton) {
    accessibilityButton.click();
  }
});
```

## ğŸ“„ ë¬¸ì„œ ì‘ì„± ê·œì¹™

### ë³´ê³ ì„œ ì‘ì„± ì‹œ ë‚ ì§œ ë°˜ì˜

### âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (í˜„ì¬ ë‚ ì§œ ì‚¬ìš©)
ë³´ê³ ì„œë‚˜ ë¬¸ì„œë¥¼ ì‘ì„±í•  ë•ŒëŠ” **ë°˜ë“œì‹œ í˜„ì¬ ë‚ ì§œë¥¼ í™•ì¸**í•˜ê³  ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤:

```bash
# PowerShellì—ì„œ í˜„ì¬ ë‚ ì§œ í™•ì¸
powershell -Command "Get-Date -Format 'yyyyë…„ MMì›” ddì¼'"
```

ë³´ê³ ì„œ ì‘ì„± ì˜ˆì‹œ:
```markdown
**ì‘ì„±ì¼**: 2025ë…„ 11ì›” 24ì¼  
**ì‘ì—… ê¸°ê°„**: 2025ë…„ 11ì›” 24ì¼
```

### âŒ ì˜ëª»ëœ ë°©ë²• (ì„ì˜ì˜ ë‚ ì§œ ì‚¬ìš©)
```markdown
**ì‘ì„±ì¼**: 2024ë…„ 12ì›” 25ì¼  # âŒ ì„ì˜ì˜ ë‚ ì§œ ì‚¬ìš©
```

**ì¤‘ìš”:**
- ë³´ê³ ì„œë‚˜ ë¬¸ì„œ ì‘ì„± ì‹œ **í•­ìƒ í˜„ì¬ ë‚ ì§œë¥¼ í™•ì¸**í•œ í›„ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
- `run_terminal_cmd` ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜„ì¬ ë‚ ì§œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ë‚ ì§œ í˜•ì‹: `yyyyë…„ MMì›” ddì¼` (ì˜ˆ: 2025ë…„ 11ì›” 24ì¼)
- ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ëª…ì˜ íƒ€ì„ìŠ¤íƒ¬í”„ëŠ” ìƒì„± ì‹œì ì„ ë‚˜íƒ€ë‚´ë¯€ë¡œ ë³€ê²½í•˜ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤

## ğŸ–¼ï¸ Flutter ì›¹ ì•± ì´ë¯¸ì§€ ì—…ë¡œë“œ ë°©ë²•

Flutter ì›¹ ì•±ì—ì„œ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ëŠ” ë°©ë²•:

### âœ… ì˜¬ë°”ë¥¸ ë°©ë²•

1. **ì´ë¯¸ì§€ íŒŒì¼ì„ ì›¹ ì„œë²„ì— ë³µì‚¬**:
```bash
# Flutter ì›¹ ì•±ì´ localhost:3001ì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ê²½ìš°
powershell -Command "Copy-Item 'ì´ë¯¸ì§€íŒŒì¼.png' -Destination 'web/' -Force"
```

2. **"ì´ë¯¸ì§€ ì„ íƒ" ë²„íŠ¼ í´ë¦­ í›„ file inputì— ì´ë¯¸ì§€ ì„¤ì •**:
```javascript
// ì´ë¯¸ì§€ ì„ íƒ ë²„íŠ¼ í´ë¦­
await page.locator('button:has-text("ì´ë¯¸ì§€ ì„ íƒ")').click();
await page.waitForTimeout(1000);

// fetchë¡œ ì´ë¯¸ì§€ ê°€ì ¸ì™€ì„œ File ê°ì²´ ìƒì„±
const response = await fetch('http://localhost:3001/ì´ë¯¸ì§€íŒŒì¼.png');
const blob = await response.blob();
const file = new File([blob], 'ì´ë¯¸ì§€íŒŒì¼.png', { type: 'image/png' });

// file input ì°¾ì•„ì„œ DataTransferë¡œ íŒŒì¼ ì„¤ì •
const fileInput = document.querySelector('input[type="file"]');
const dataTransfer = new DataTransfer();
dataTransfer.items.add(file);
fileInput.files = dataTransfer.files;

// change ì´ë²¤íŠ¸ ë°œìƒ
const changeEvent = new Event('change', { bubbles: true });
fileInput.dispatchEvent(changeEvent);
```

**ì¤‘ìš”:**
- "ì´ë¯¸ì§€ ì„ íƒ" ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ file inputì´ ë‚˜íƒ€ë‚¨
- `DataTransfer` APIë¥¼ ì‚¬ìš©í•˜ì—¬ íŒŒì¼ì„ ì„¤ì •í•´ì•¼ í•¨
- ì´ë¯¸ì§€ íŒŒì¼ì€ Flutter ì›¹ ì•±ê³¼ ê°™ì€ ë„ë©”ì¸(localhost:3001)ì—ì„œ ì œê³µë˜ì–´ì•¼ í•¨

## â° DateTime(ì¼ì‹œ) ì²˜ë¦¬ ê·œì¹™

**í•µì‹¬ ì›ì¹™:**
- ëª¨ë“  DateTimeì€ **í•œêµ­ ì‹œê°„(KST, UTC+9)** ê¸°ì¤€ìœ¼ë¡œ ì²˜ë¦¬
- DBì—ëŠ” UTCë¡œ ì €ì¥í•˜ë˜, ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œëŠ” í•­ìƒ í•œêµ­ ì‹œê°„ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì‚¬ìš©

**1. DateTime ìƒì„±**
```dart
import '../../utils/date_time_utils.dart';

final dateTime = DateTimeUtils.nowKST().copyWith(
  year: date.year,
  month: date.month,
  day: date.day,
  hour: time.hour,
  minute: time.minute,
  second: 0,
  millisecond: 0,
);
```

**2. í˜„ì¬ ì‹œê°„ ì‚¬ìš©**
```dart
final now = DateTimeUtils.nowKST();
```

**3. DBì— ì €ì¥**
```dart
import '../utils/date_time_utils.dart';

'p_apply_start_date': DateTimeUtils.toIso8601StringKST(applyStartDate),
```

**4. DBì—ì„œ ì½ê¸°**
```dart
import '../utils/date_time_utils.dart';

applyStartDate: json['apply_start_date'] != null
    ? DateTimeUtils.parseKST(json['apply_start_date'])
    : DateTimeUtils.nowKST().add(const Duration(days: 1)),
```

**5. ì‹œê°„ ë¹„êµ**
```dart
import '../../../utils/date_time_utils.dart';

void _updateFilteredCampaigns() {
  final now = DateTimeUtils.nowKST();
  _pendingCampaigns = _allCampaigns.where((campaign) {
    return campaign.applyStartDate.isAfter(now);
  }).toList();
}
```

**6. ë‚ ì§œ/ì‹œê°„ í‘œì‹œ**
```dart
import '../../../utils/date_time_utils.dart';

Text(DateTimeUtils.formatKST(dateTime)) // "2025-11-25 14:30"
```

**ê¸ˆì§€ ì‚¬í•­:**
- âŒ `DateTime.now()` ì§ì ‘ ì‚¬ìš© ê¸ˆì§€ â†’ `DateTimeUtils.nowKST()` ì‚¬ìš©
- âŒ `.toLocal()` ì‚¬ìš© ê¸ˆì§€ â†’ `DateTimeUtils.parseKST()` ì‚¬ìš©
- âŒ `.toIso8601String()` ì§ì ‘ ì‚¬ìš© ê¸ˆì§€ â†’ `DateTimeUtils.toIso8601StringKST()` ì‚¬ìš©

## ğŸ” Custom JWT ì„¸ì…˜ ì§€ì› (ë„¤ì´ë²„ ë¡œê·¸ì¸)

**í•µì‹¬ ì›ì¹™:**
- ë„¤ì´ë²„ ë¡œê·¸ì¸ì€ Custom JWT ì„¸ì…˜ì„ ì‚¬ìš©í•˜ë¯€ë¡œ, `supabase.auth.currentUser`ê°€ `null`ì¼ ìˆ˜ ìˆìŒ
- ëª¨ë“  ì„œë¹„ìŠ¤ ë©”ì„œë“œì—ì„œ ì‚¬ìš©ì IDë¥¼ ê°€ì ¸ì˜¬ ë•ŒëŠ” **ë°˜ë“œì‹œ Custom JWT ì„¸ì…˜ë„ ì²´í¬**í•´ì•¼ í•¨
- Custom JWT ì„¸ì…˜ê³¼ Supabase ì„¸ì…˜ì„ ëª¨ë‘ ì§€ì›í•˜ë„ë¡ ê°œë°œí•´ì•¼ í•¨

### âœ… ì˜¬ë°”ë¥¸ ë°©ë²• (ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸°)

**1. ì„œë¹„ìŠ¤ ë©”ì„œë“œì—ì„œ ì‚¬ìš©ì ID ê°€ì ¸ì˜¤ê¸°**
```dart
import 'auth_service.dart';

// âŒ ì˜ëª»ëœ ë°©ë²•
final user = _supabase.auth.currentUser;
if (user == null) {
  throw Exception('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
}
final userId = user.id;

// âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
final userId = await AuthService.getCurrentUserId();
if (userId == null) {
  throw Exception('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
}
```

**2. RPC í•¨ìˆ˜ í˜¸ì¶œ ì‹œ ì‚¬ìš©ì ID ì‚¬ìš©**
```dart
// âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
final userId = await AuthService.getCurrentUserId();
if (userId == null) {
  return ApiResponse(success: false, error: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
}

final response = await _supabase.rpc(
  'some_rpc_function',
  params: {'p_user_id': userId, ...},
);
```

**3. ì§ì ‘ ì¿¼ë¦¬ ì‹œ ì‚¬ìš©ì ID ì‚¬ìš©**
```dart
// âœ… ì˜¬ë°”ë¥¸ ë°©ë²•
final userId = await AuthService.getCurrentUserId();
if (userId == null) {
  return ApiResponse(success: false, error: 'ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
}

final response = await _supabase
    .from('some_table')
    .select()
    .eq('user_id', userId);
```

### âŒ ì˜ëª»ëœ ë°©ë²•

```dart
// âŒ ì˜ëª»ëœ ë°©ë²• 1: currentUser ì§ì ‘ ì‚¬ìš©
final user = _supabase.auth.currentUser;
if (user == null) {
  throw Exception('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
}
// Custom JWT ì„¸ì…˜ì—ì„œëŠ” currentUserê°€ nullì´ë¯€ë¡œ ì‹¤íŒ¨í•¨

// âŒ ì˜ëª»ëœ ë°©ë²• 2: currentUser?.id ì‚¬ìš©
final userId = _supabase.auth.currentUser?.id;
if (userId == null) {
  throw Exception('ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤');
}
// Custom JWT ì„¸ì…˜ì—ì„œëŠ” nullì´ ë°˜í™˜ë˜ì–´ ì‹¤íŒ¨í•¨

// âŒ ì˜ëª»ëœ ë°©ë²• 3: currentSession ì‚¬ìš©
final session = _supabase.auth.currentSession;
final userId = session?.user.id;
// Custom JWT ì„¸ì…˜ì—ì„œëŠ” sessionì´ nullì´ë¯€ë¡œ ì‹¤íŒ¨í•¨
```

### ğŸ“‹ ì²´í¬ë¦¬ìŠ¤íŠ¸

ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ë©”ì„œë“œë¥¼ ì‘ì„±í•  ë•Œ ë‹¤ìŒì„ í™•ì¸í•˜ì„¸ìš”:

1. âœ… `AuthService.getCurrentUserId()`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì‚¬ìš©ì IDë¥¼ ê°€ì ¸ì˜¤ëŠ”ê°€?
2. âœ… Custom JWT ì„¸ì…˜ê³¼ Supabase ì„¸ì…˜ì„ ëª¨ë‘ ì§€ì›í•˜ëŠ”ê°€?
3. âœ… ì‚¬ìš©ì IDê°€ `null`ì¸ ê²½ìš° ì ì ˆí•œ ì—ëŸ¬ ì²˜ë¦¬ë¥¼ í•˜ëŠ”ê°€?
4. âœ… RPC í•¨ìˆ˜ í˜¸ì¶œ ì‹œ `p_user_id` íŒŒë¼ë¯¸í„°ì— ì˜¬ë°”ë¥¸ `userId`ë¥¼ ì „ë‹¬í•˜ëŠ”ê°€?
5. âœ… ì§ì ‘ ì¿¼ë¦¬ ì‹œ `.eq('user_id', userId)` í˜•íƒœë¡œ ì˜¬ë°”ë¥´ê²Œ ì‚¬ìš©í•˜ëŠ”ê°€?

### ğŸ” ì˜í–¥ë°›ëŠ” ì„œë¹„ìŠ¤

ë‹¤ìŒ ì„œë¹„ìŠ¤ë“¤ì€ ì´ë¯¸ Custom JWT ì„¸ì…˜ì„ ì§€ì›í•˜ë„ë¡ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤:
- âœ… `AuthService` - `getCurrentUserId()` ì •ì  ë©”ì„œë“œ ì œê³µ
- âœ… `SNSPlatformConnectionService` - ëª¨ë“  ë©”ì„œë“œ
- âœ… `WalletService` - ëª¨ë“  ë©”ì„œë“œ
- âœ… `CampaignService` - ì‚¬ìš©ì ê´€ë ¨ ë©”ì„œë“œ
- âœ… `CampaignApplicationService` - ëª¨ë“  ë©”ì„œë“œ
- âœ… `ReviewService` - ëª¨ë“  ë©”ì„œë“œ
- âœ… `NotificationService` - ëª¨ë“  ë©”ì„œë“œ
- âœ… `AccountDeletionService` - ëª¨ë“  ë©”ì„œë“œ

**ì¤‘ìš”:**
- ìƒˆë¡œìš´ ì„œë¹„ìŠ¤ ë©”ì„œë“œë¥¼ ì¶”ê°€í•  ë•ŒëŠ” **ë°˜ë“œì‹œ** `AuthService.getCurrentUserId()`ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤
- ê¸°ì¡´ ì½”ë“œë¥¼ ìˆ˜ì •í•  ë•Œë„ `_supabase.auth.currentUser`ë¥¼ ì‚¬ìš©í•˜ëŠ” ë¶€ë¶„ì´ ìˆë‹¤ë©´ ìˆ˜ì •í•´ì•¼ í•©ë‹ˆë‹¤
- Custom JWT ì„¸ì…˜ì€ ë„¤ì´ë²„ ë¡œê·¸ì¸ì—ì„œë§Œ ì‚¬ìš©ë˜ë©°, ë‹¤ë¥¸ OAuth ì œê³µì(Google, Kakao)ëŠ” Supabase ì„¸ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤